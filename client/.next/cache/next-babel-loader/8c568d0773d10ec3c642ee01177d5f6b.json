{"ast":null,"code":"import _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _Number$EPSILON from \"@babel/runtime-corejs2/core-js/number/epsilon\";\nvar _jsxFileName = \"C:\\\\Users\\\\Karim\\\\Documents\\\\GitHub\\\\PrimeTime\\\\client\\\\pages\\\\placeorder.js\";\nvar __jsx = React.createElement;\nimport React, { useContext, useEffect, useReducer, useState } from 'react';\nimport dynamic from 'next/dynamic';\nimport { Store } from '../utils/Store';\nimport NextLink from 'next/link';\nimport Axios from \"axios\";\nimport Cookies from 'js-cookie';\nimport { Grid, TableContainer, Table, Typography, TableHead, TableBody, TableRow, TableCell, Link, Select, MenuItem, Button, Card, List, ListItem } from '@material-ui/core';\nimport { useRouter } from 'next/router';\nimport CommonLayout from '../containers/common/common-layout';\nimport { CardBody, CardText, CardTitle, Col, ListGroup, Row } from 'reactstrap';\nimport CheckoutSteps from '../components/CheckoutSteps';\n\nfunction PlaceOrder() {\n  const router = useRouter();\n  const {\n    0: order,\n    1: setOrder\n  } = useState({\n    _id: ''\n  });\n  const {\n    state,\n    dispatch\n  } = useContext(Store);\n  const {\n    cart: {\n      cartItems,\n      shippingAddress,\n      paymentMethod\n    },\n    userInfo\n  } = state;\n\n  const round2 = num => Math.round(num * 100 + _Number$EPSILON) / 100; // 123.456 => 123.46\n\n\n  const itemsPrice = round2(cartItems.reduce((a, c) => a + c.price * c.quantity, 0));\n  const shippingPrice = itemsPrice > 200 ? 0 : 15;\n  const taxPrice = round2(itemsPrice * 1);\n  const totalPrice = round2(itemsPrice + shippingPrice + taxPrice);\n\n  const placeOrderHandler = () => {\n    Axios.post('http://localhost:5000/orders', {\n      orderItems: cartItems,\n      shippingAddress: shippingAddress,\n      paymentMethod: paymentMethod,\n      itemsPrice: itemsPrice,\n      shippingPrice: shippingPrice,\n      taxPrice: taxPrice,\n      totalPrice: totalPrice,\n      user: userInfo._id\n    }).then(res => {\n      setOrder(res.data);\n      console.log(\"success\");\n      console.log(res.data.order._id);\n      router.push(`/order/${res.data.order._id}`);\n    }); //console.log(data);\n\n    Cookies.remove('cartItems');\n  };\n  /* const placeOrderHandler = async () => {\r\n      try {\r\n        dispatch({ type: 'CREATE_REQUEST' });\r\n  \r\n        const { data } = await Axios.post(\r\n          'http://localhost:5000/orders',\r\n          {\r\n            orderItems: cartItems,\r\n            shippingAddress: shippingAddress,\r\n            paymentMethod: paymentMethod,\r\n            itemsPrice: itemsPrice,\r\n            shippingPrice: shippingPrice,\r\n            taxPrice: taxPrice,\r\n            totalPrice: totalPrice,\r\n            user:userInfo._id\r\n          },\r\n          {\r\n            headers: {\r\n              authorization: `Bearer ${userInfo.token}`,\r\n            },\r\n          }\r\n        );\r\n        ctxDispatch({ type: 'CART_CLEAR' });\r\n        dispatch({ type: 'CREATE_SUCCESS' });\r\n        \r\n        //localStorage.removeItem('cartItems');\r\n        router.push(`/order/${userInfo.token}`);\r\n      } catch (err) {\r\n        dispatch({ type: 'CREATE_FAIL' });\r\n        \r\n      }\r\n    };*/\n\n\n  useEffect(() => {\n    if (!paymentMethod) {\n      router.push('/payment');\n    }\n  }, []);\n  return __jsx(CommonLayout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"container small-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }\n  }), __jsx(CheckoutSteps, {\n    activeStep: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }\n  }), __jsx(\"div\", {\n    className: \"container small-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  }), __jsx(\"h5\", {\n    className: \"my-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }\n  }, \"Preview Order\"), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }\n  }, __jsx(Col, {\n    md: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 9\n    }\n  }, __jsx(Card, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 11\n    }\n  }, __jsx(CardBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 13\n    }\n  }, __jsx(CardTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 15\n    }\n  }, \"Shipping\"), __jsx(CardText, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 15\n    }\n  }, __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 17\n    }\n  }, \"Name:\"), \" \", shippingAddress.fullName, \" \", __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 67\n    }\n  }), __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 17\n    }\n  }, \"Address: \"), \" \", shippingAddress.address, \",\", shippingAddress.city, \", \", shippingAddress.postalCode, \",\", shippingAddress.country), __jsx(NextLink, {\n    href: \"/ShippingAddress\",\n    passHref: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 15\n    }\n  }, \"Edit\"))), __jsx(Card, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 11\n    }\n  }, __jsx(CardBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }\n  }, __jsx(CardTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 15\n    }\n  }, \"Payment\"), __jsx(CardText, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 15\n    }\n  }, __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 17\n    }\n  }, \"Method:\"), \" \", paymentMethod))), __jsx(Card, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 11\n    }\n  }, __jsx(CardBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }\n  }, __jsx(CardTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 15\n    }\n  }, \"Items\"), __jsx(ListGroup, {\n    variant: \"flush\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 15\n    }\n  }, cartItems.map(item => __jsx(ListItem, {\n    key: item._id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 19\n    }\n  }, __jsx(Row, {\n    className: \"align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 21\n    }\n  }, __jsx(Col, {\n    md: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 23\n    }\n  }, __jsx(\"img\", {\n    src: item.image,\n    alt: item.name,\n    className: \"img-fluid rounded img-thumbnail\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 25\n    }\n  }), ' ', __jsx(Link, {\n    to: `/product/${item.slug}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 25\n    }\n  }, item.name)), __jsx(Col, {\n    md: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 23\n    }\n  }, __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 25\n    }\n  }, item.quantity)), __jsx(Col, {\n    md: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 23\n    }\n  }, \"$\", item.price))))), __jsx(NextLink, {\n    href: \"/cart\",\n    passHref: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 15\n    }\n  }, \"Edit\")))), __jsx(Col, {\n    md: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 11\n    }\n  }, __jsx(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 11\n    }\n  }, __jsx(CardBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 13\n    }\n  }, __jsx(CardTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 15\n    }\n  }, \"Order Summary\"), __jsx(ListGroup, {\n    variant: \"flush\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 15\n    }\n  }, __jsx(ListItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 17\n    }\n  }, __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 21\n    }\n  }, \"Items\"), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 21\n    }\n  }, \"$\", itemsPrice.toFixed(2)))), __jsx(ListItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 17\n    }\n  }, __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 21\n    }\n  }, \"Shipping\"), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 21\n    }\n  }, \"$\", shippingPrice.toFixed(2)))), __jsx(ListItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 17\n    }\n  }, __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 21\n    }\n  }, \"Tax\"), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 21\n    }\n  }, \"$\", taxPrice.toFixed(2)))), __jsx(ListItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 17\n    }\n  }, __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 21\n    }\n  }, __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 23\n    }\n  }, \" Order Total\")), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 21\n    }\n  }, __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 23\n    }\n  }, \"$\", totalPrice.toFixed(2))))), __jsx(ListItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: \"d-grid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 19\n    }\n  }, __jsx(Button, {\n    type: \"button\",\n    onClick: placeOrderHandler,\n    disabled: cartItems.length === 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 21\n    }\n  }, \"Place Order\")))))))));\n}\n\nexport default dynamic(() => _Promise.resolve(PlaceOrder), {\n  ssr: false\n});","map":{"version":3,"sources":["C:/Users/Karim/Documents/GitHub/PrimeTime/client/pages/placeorder.js"],"names":["React","useContext","useEffect","useReducer","useState","dynamic","Store","NextLink","Axios","Cookies","Grid","TableContainer","Table","Typography","TableHead","TableBody","TableRow","TableCell","Link","Select","MenuItem","Button","Card","List","ListItem","useRouter","CommonLayout","CardBody","CardText","CardTitle","Col","ListGroup","Row","CheckoutSteps","PlaceOrder","router","order","setOrder","_id","state","dispatch","cart","cartItems","shippingAddress","paymentMethod","userInfo","round2","num","Math","round","itemsPrice","reduce","a","c","price","quantity","shippingPrice","taxPrice","totalPrice","placeOrderHandler","post","orderItems","user","then","res","data","console","log","push","remove","fullName","address","city","postalCode","country","map","item","image","name","slug","toFixed","length","resolve","ssr"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useReducer, useState } from 'react';\r\nimport dynamic from 'next/dynamic';\r\n\r\nimport { Store } from '../utils/Store';\r\nimport NextLink from 'next/link';\r\nimport Axios  from \"axios\";\r\nimport Cookies  from 'js-cookie';\r\n\r\nimport {\r\n  Grid,\r\n  TableContainer,\r\n  Table,\r\n  Typography,\r\n  TableHead,\r\n  TableBody,\r\n  TableRow,\r\n  TableCell,\r\n  Link,\r\n  Select,\r\n  MenuItem,\r\n  Button,\r\n  Card,\r\n  List,\r\n  ListItem,\r\n} from '@material-ui/core';\r\n\r\nimport { useRouter } from 'next/router';\r\n\r\nimport CommonLayout from '../containers/common/common-layout';\r\nimport { CardBody, CardText, CardTitle, Col, ListGroup, Row } from 'reactstrap';\r\nimport CheckoutSteps from '../components/CheckoutSteps';\r\n\r\nfunction PlaceOrder() {\r\n\r\n  const router = useRouter();\r\n  const [order, setOrder] = useState({ _id:''});\r\n  const { state, dispatch } = useContext(Store);\r\n  const {\r\n    cart: { cartItems, shippingAddress, paymentMethod },\r\n    userInfo\r\n  } = state;\r\n  const round2 = (num) => Math.round(num * 100 + Number.EPSILON) / 100; // 123.456 => 123.46\r\n  const itemsPrice = round2(\r\n    cartItems.reduce((a, c) => a + c.price * c.quantity, 0)\r\n  );\r\n  const shippingPrice = itemsPrice > 200 ? 0 : 15;\r\n  const taxPrice = round2(itemsPrice * 1);\r\n  const totalPrice = round2(itemsPrice + shippingPrice + taxPrice);\r\n  \r\n \r\n  \r\n  \r\n\r\n\r\n  const placeOrderHandler =   () => {\r\n  \r\n    \r\n\r\n     Axios.post(\r\n        'http://localhost:5000/orders',\r\n        {\r\n          orderItems: cartItems,\r\n          shippingAddress: shippingAddress,\r\n          paymentMethod: paymentMethod,\r\n          itemsPrice: itemsPrice,\r\n          shippingPrice: shippingPrice,\r\n          taxPrice: taxPrice,\r\n          totalPrice: totalPrice,\r\n          user:userInfo._id,\r\n        \r\n        }).then( res => {\r\n          setOrder(res.data);\r\n          console.log(\"success\");\r\n          console.log(res.data.order._id);\r\n          router.push(`/order/${res.data.order._id}`);\r\n         \r\n         });\r\n        \r\n      //console.log(data);\r\n      Cookies.remove('cartItems');\r\n     \r\n      }\r\n    \r\n  \r\n/* const placeOrderHandler = async () => {\r\n    try {\r\n      dispatch({ type: 'CREATE_REQUEST' });\r\n\r\n      const { data } = await Axios.post(\r\n        'http://localhost:5000/orders',\r\n        {\r\n          orderItems: cartItems,\r\n          shippingAddress: shippingAddress,\r\n          paymentMethod: paymentMethod,\r\n          itemsPrice: itemsPrice,\r\n          shippingPrice: shippingPrice,\r\n          taxPrice: taxPrice,\r\n          totalPrice: totalPrice,\r\n          user:userInfo._id\r\n        },\r\n        {\r\n          headers: {\r\n            authorization: `Bearer ${userInfo.token}`,\r\n          },\r\n        }\r\n      );\r\n      ctxDispatch({ type: 'CART_CLEAR' });\r\n      dispatch({ type: 'CREATE_SUCCESS' });\r\n      \r\n      //localStorage.removeItem('cartItems');\r\n      router.push(`/order/${userInfo.token}`);\r\n    } catch (err) {\r\n      dispatch({ type: 'CREATE_FAIL' });\r\n      \r\n    }\r\n  };*/\r\n\r\n\r\n\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    if (!paymentMethod) {\r\n      router.push('/payment');\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <CommonLayout>\r\n      <div className=\"container small-container\"></div>\r\n      <CheckoutSteps activeStep={3}></CheckoutSteps>\r\n      <div className=\"container small-container\"></div>\r\n      \r\n      <h5 className=\"my-3\">Preview Order</h5>\r\n      <Row>\r\n        <Col md={8}>\r\n          <Card className=\"mb-3\">\r\n            <CardBody>\r\n              <CardTitle>Shipping</CardTitle>\r\n              <CardText>\r\n                <strong>Name:</strong> {shippingAddress.fullName} <br />\r\n                <strong>Address: </strong> {shippingAddress.address},\r\n                {shippingAddress.city}, {shippingAddress.postalCode},\r\n                {shippingAddress.country}\r\n              </CardText>\r\n              <NextLink href=\"/ShippingAddress\" passHref>Edit</NextLink>\r\n            </CardBody>\r\n          </Card>\r\n          <Card className=\"mb-3\">\r\n            <CardBody>\r\n              <CardTitle>Payment</CardTitle>\r\n              <CardText>\r\n                <strong>Method:</strong> {paymentMethod}\r\n              </CardText>\r\n              \r\n            </CardBody>\r\n          </Card>\r\n          <Card className=\"mb-3\">\r\n            <CardBody>\r\n              <CardTitle>Items</CardTitle>\r\n              <ListGroup variant=\"flush\">\r\n                {cartItems.map((item) => (\r\n                  <ListItem key={item._id}>\r\n                    <Row className=\"align-items-center\">\r\n                      <Col md={6}>\r\n                        <img\r\n                          src={item.image}\r\n                          alt={item.name}\r\n                          className=\"img-fluid rounded img-thumbnail\"\r\n                        ></img>{' '}\r\n                        <Link to={`/product/${item.slug}`}>{item.name}</Link>\r\n                      </Col>\r\n                      <Col md={3}>\r\n                        <span>{item.quantity}</span>\r\n                      </Col>\r\n                      <Col md={3}>${item.price}</Col>\r\n                    </Row>\r\n                  </ListItem>\r\n                ))}\r\n              </ListGroup>\r\n              <NextLink href=\"/cart\" passHref>Edit</NextLink>\r\n            </CardBody>\r\n          </Card>\r\n          </Col>\r\n          <Col md={4}>\r\n          <Card>\r\n            <CardBody>\r\n              <CardTitle>Order Summary</CardTitle>\r\n              <ListGroup variant=\"flush\">\r\n                <ListItem>\r\n                  <Row>\r\n                    <Col>Items</Col>\r\n                    <Col>${itemsPrice.toFixed(2)}</Col>\r\n                  </Row>\r\n                </ListItem>\r\n                <ListItem>\r\n                  <Row>\r\n                    <Col>Shipping</Col>\r\n                    <Col>${shippingPrice.toFixed(2)}</Col>\r\n                  </Row>\r\n                </ListItem>\r\n                <ListItem>\r\n                  <Row>\r\n                    <Col>Tax</Col>\r\n                    <Col>${taxPrice.toFixed(2)}</Col>\r\n                  </Row>\r\n                </ListItem>\r\n                <ListItem>\r\n                  <Row>\r\n                    <Col>\r\n                      <strong> Order Total</strong>\r\n                    </Col>\r\n                    <Col>\r\n                      <strong>${totalPrice.toFixed(2)}</strong>\r\n                    </Col>\r\n                  </Row>\r\n                </ListItem>\r\n                <ListItem>\r\n                  <div className=\"d-grid\">\r\n                    <Button\r\n                      type=\"button\"\r\n                      onClick={placeOrderHandler}\r\n                      disabled={cartItems.length === 0}\r\n                    >\r\n                      Place Order\r\n                    </Button>\r\n                  </div>\r\n                </ListItem>\r\n              </ListGroup>\r\n            </CardBody>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    \r\n\r\n    </CommonLayout>\r\n  );\r\n}\r\n\r\nexport default dynamic(() => Promise.resolve(PlaceOrder), { ssr: false });"]},"metadata":{},"sourceType":"module"}